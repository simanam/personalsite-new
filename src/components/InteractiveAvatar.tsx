'use client'

import { useEffect, useRef, useState, useCallback } from 'react'
import { motion, useAnimation, useMotionValue, useSpring } from 'framer-motion'

type Expression = 'neutral' | 'happy' | 'curious' | 'wink' | 'crosseyed'

interface InteractiveAvatarProps {
  isThinking?: boolean
}

export default function InteractiveAvatar({ isThinking = false }: InteractiveAvatarProps) {
  const svgRef = useRef<SVGSVGElement>(null)
  const [expression, setExpression] = useState<Expression>('neutral')
  const [isHovering, setIsHovering] = useState(false)
  const [isNoseHover, setIsNoseHover] = useState(false)
  const leftEyeControls = useAnimation()
  const rightEyeControls = useAnimation()

  // Use motion values for smooth eye tracking
  const leftEyeX = useMotionValue(0)
  const leftEyeY = useMotionValue(0)
  const rightEyeX = useMotionValue(0)
  const rightEyeY = useMotionValue(0)

  // Motion values for eyebrows
  const leftBrowY = useMotionValue(0)
  const leftBrowRotate = useMotionValue(0)
  const rightBrowY = useMotionValue(0)
  const rightBrowRotate = useMotionValue(0)

  // Add spring physics to eye movement
  const leftEyeXSpring = useSpring(leftEyeX, { stiffness: 300, damping: 30 })
  const leftEyeYSpring = useSpring(leftEyeY, { stiffness: 300, damping: 30 })
  const rightEyeXSpring = useSpring(rightEyeX, { stiffness: 300, damping: 30 })
  const rightEyeYSpring = useSpring(rightEyeY, { stiffness: 300, damping: 30 })

  // Spring physics for eyebrows (slower, more subtle)
  const leftBrowYSpring = useSpring(leftBrowY, { stiffness: 150, damping: 20 })
  const leftBrowRotateSpring = useSpring(leftBrowRotate, { stiffness: 150, damping: 20 })
  const rightBrowYSpring = useSpring(rightBrowY, { stiffness: 150, damping: 20 })
  const rightBrowRotateSpring = useSpring(rightBrowRotate, { stiffness: 150, damping: 20 })

  // Mouse move handler
  const handleMouseMove = useCallback((e: MouseEvent) => {
    if (!svgRef.current) return

    const rect = svgRef.current.getBoundingClientRect()
    const svgCenterX = rect.left + rect.width / 2
    const svgCenterY = rect.top + rect.height / 3 // Eyes are in upper third

    // Nose position (center of face, slightly below eyes)
    const noseX = rect.left + rect.width / 2
    const noseY = rect.top + rect.height * 0.48 // Nose is around 48% from top

    const deltaX = e.clientX - svgCenterX
    const deltaY = e.clientY - svgCenterY

    // Check if mouse is near the nose
    const distanceToNose = Math.sqrt(
      Math.pow(e.clientX - noseX, 2) + Math.pow(e.clientY - noseY, 2)
    )
    const noseRadius = rect.width * 0.08 // Detection radius around nose
    const isOnNose = distanceToNose < noseRadius

    setIsNoseHover(isOnNose)

    if (isOnNose) {
      // Cross-eyed effect: left eye looks right, right eye looks left
      // Need larger values to make the cross-eye effect obvious
      leftEyeX.set(12)  // Left eye looks strongly toward center (right)
      leftEyeY.set(8)   // Looking down at nose
      rightEyeX.set(-12) // Right eye looks strongly toward center (left)
      rightEyeY.set(8)   // Looking down at nose

      // Raise eyebrows in surprise
      leftBrowY.set(-6)
      rightBrowY.set(-6)
      leftBrowRotate.set(-3)
      rightBrowRotate.set(3)
    } else {
      const maxOffset = 6
      const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY)
      const maxDistance = 400

      // Normalize and clamp
      const normalizedDistance = Math.min(distance / maxDistance, 1)
      const angle = Math.atan2(deltaY, deltaX)

      const offsetX = Math.cos(angle) * maxOffset * normalizedDistance
      const offsetY = Math.sin(angle) * maxOffset * normalizedDistance

      // Update both eyes
      leftEyeX.set(offsetX)
      leftEyeY.set(offsetY)
      rightEyeX.set(offsetX)
      rightEyeY.set(offsetY)

      // Update eyebrows based on mouse position
      // Eyebrows raise when looking up, lower when looking down
      const browVerticalOffset = -offsetY * 0.5 // Inverted: looking up raises brows

      // Add slight asymmetric movement based on horizontal position
      // When looking left, left brow raises slightly more
      // When looking right, right brow raises slightly more
      const asymmetryFactor = offsetX * 0.3

      leftBrowY.set(browVerticalOffset - asymmetryFactor)
      rightBrowY.set(browVerticalOffset + asymmetryFactor)

      // Subtle rotation - brows tilt toward where you're looking
      leftBrowRotate.set(offsetX * 0.5)
      rightBrowRotate.set(offsetX * 0.5)
    }
  }, [leftEyeX, leftEyeY, rightEyeX, rightEyeY, leftBrowY, rightBrowY, leftBrowRotate, rightBrowRotate])

  useEffect(() => {
    window.addEventListener('mousemove', handleMouseMove)
    return () => window.removeEventListener('mousemove', handleMouseMove)
  }, [handleMouseMove])

  // Auto-blink effect
  useEffect(() => {
    const blink = () => {
      if (expression !== 'wink') {
        leftEyeControls.start({ scaleY: 0.1, transition: { duration: 0.08 } })
        rightEyeControls.start({ scaleY: 0.1, transition: { duration: 0.08 } })

        setTimeout(() => {
          leftEyeControls.start({ scaleY: 1, transition: { duration: 0.08 } })
          rightEyeControls.start({ scaleY: 1, transition: { duration: 0.08 } })
        }, 80)
      }
    }

    // Initial blink after mount
    const initialTimeout = setTimeout(blink, 1000)

    // Random blink interval
    const blinkInterval = setInterval(() => {
      blink()
    }, 2500 + Math.random() * 2000)

    return () => {
      clearTimeout(initialTimeout)
      clearInterval(blinkInterval)
    }
  }, [expression, leftEyeControls, rightEyeControls])

  // Expression change on hover
  useEffect(() => {
    if (isHovering) {
      const expressions: Expression[] = ['happy', 'curious', 'wink']
      setExpression(expressions[Math.floor(Math.random() * expressions.length)])
    } else {
      setExpression('neutral')
    }
  }, [isHovering])

  const getSmilePath = () => {
    // When hovering nose, return empty path (we'll show O mouth instead)
    if (isNoseHover) {
      return ""
    }
    switch (expression) {
      case 'happy':
        return "M219 293C232.943 298.5 264.663 305 280 293"
      case 'curious':
        return "M219 299C232.943 302 264.663 302 280 299"
      case 'wink':
        return "M219 295C232.943 300 264.663 307 280 295"
      default:
        return "M219 298.928C232.943 303.91 264.663 310.499 280 297"
    }
  }

  return (
    <motion.div
      className="relative cursor-pointer"
      onMouseEnter={() => setIsHovering(true)}
      onMouseLeave={() => setIsHovering(false)}
      initial={{ opacity: 0, y: 50 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ type: 'spring', bounce: 0.5, duration: 0.8 }}
    >
      <svg
        ref={svgRef}
        width="500"
        height="533"
        viewBox="0 0 500 533"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className="w-full h-auto max-w-md"
      >
        {/* Base masks and body structure */}
        <defs>
          <filter id="glow">
            <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
            <feMerge>
              <feMergeNode in="coloredBlur"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>
          <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
            <feDropShadow dx="0" dy="4" stdDeviation="8" floodColor="#7f00e0" floodOpacity="0.15"/>
          </filter>
        </defs>

        {/* Head and face base */}
        <mask id="mask0_5_85" style={{ maskType: 'alpha' }} maskUnits="userSpaceOnUse" x="60" y="68" width="380" height="465">
          <path d="M295.455 343.806V378.811H303.03C378.342 378.811 439.394 440.173 439.394 515.868V533H60.6061V515.868C60.6061 440.173 121.658 378.811 196.97 378.811H204.545V343.806C171.899 328.218 148.432 296.361 144.517 258.66C133.485 257.092 125 247.563 125 236.043V209.393C125 198.074 133.19 188.678 143.939 186.866V175.129C143.939 116.255 191.424 68.5286 250 68.5286C308.576 68.5286 356.061 116.255 356.061 175.129V186.866C366.81 188.678 375 198.074 375 209.393V236.043C375 247.563 366.515 257.092 355.483 258.66C351.568 296.361 328.101 328.218 295.455 343.806Z" fill="#F4F9FC"/>
        </mask>
        <g mask="url(#mask0_5_85)">
          <path d="M295.455 343.806V378.811H303.03C378.342 378.811 439.394 440.173 439.394 515.868V533H60.6061V515.868C60.6061 440.173 121.658 378.811 196.97 378.811H204.545V343.806C171.899 328.218 148.432 296.361 144.517 258.66C133.485 257.092 125 247.563 125 236.043V209.393C125 198.074 133.19 188.678 143.939 186.866V175.129C143.939 116.255 191.424 68.5286 250 68.5286C308.576 68.5286 356.061 116.255 356.061 175.129V186.866C366.81 188.678 375 198.074 375 209.393V236.043C375 247.563 366.515 257.092 355.483 258.66C351.568 296.361 328.101 328.218 295.455 343.806Z" fill="#F4F9FC"/>
          <path fillRule="evenodd" clipRule="evenodd" d="M356.061 218.911V262.693C356.061 321.566 308.576 369.293 250 369.293C191.424 369.293 143.939 321.566 143.939 262.693V218.911V247.464C143.939 306.338 191.424 354.064 250 354.064C308.576 354.064 356.061 306.338 356.061 247.464V218.911Z" fill="#F4F9FC"/>
        </g>

        {/* Shirt/Body */}
        <mask id="mask1_5_85" style={{ maskType: 'alpha' }} maskUnits="userSpaceOnUse" x="60" y="378" width="380" height="155">
          <path fillRule="evenodd" clipRule="evenodd" d="M199.228 378.909H196.97C121.658 378.909 60.6061 440.272 60.6061 515.966V533H439.394V515.966C439.394 440.272 378.342 378.909 303.03 378.909H300.772C301.013 380.782 301.136 382.687 301.136 384.62C301.136 410.903 278.242 432.209 250 432.209C221.758 432.209 198.864 410.903 198.864 384.62C198.864 382.687 198.987 380.782 199.228 378.909Z" fill="white"/>
        </mask>
        <g mask="url(#mask1_5_85)">
          <path fillRule="evenodd" clipRule="evenodd" d="M199.228 378.909H196.97C121.658 378.909 60.6061 440.272 60.6061 515.966V533H439.394V515.966C439.394 440.272 378.342 378.909 303.03 378.909H300.772C301.013 380.782 301.136 382.687 301.136 384.62C301.136 410.903 278.242 432.209 250 432.209C221.758 432.209 198.864 410.903 198.864 384.62C198.864 382.687 198.987 380.782 199.228 378.909Z" fill="white"/>
          <motion.path
            d="M62.6061 515.966C62.6061 444.305 118.127 385.693 188.27 381.188C182.876 402.848 179.818 427.654 179.818 454.002C179.818 482.061 183.286 508.374 189.351 531H62.6061V515.966ZM437.394 515.966V531H312.543C318.608 508.374 322.076 482.061 322.076 454.002C322.076 427.71 319.031 402.953 313.659 381.325C382.888 386.77 437.394 444.963 437.394 515.966Z"
            fill="#AADCEC"
            stroke="#7F00E0"
            strokeWidth="4"
            animate={{ fill: isHovering ? '#9be0f0' : '#AADCEC' }}
            transition={{ duration: 0.3 }}
          />
          <path d="M381.28 483.129L344.518 486.648L361.202 474.071C363.754 472.147 367.271 472.178 369.79 474.147L381.28 483.129Z" fill="#E6E6E6" stroke="#7F00E0"/>
          <path d="M156.97 448.445L157.872 447.085L156.721 445.929L146.481 435.636L181.219 380.508C183.791 379.75 186.326 379.263 188.828 379.041C181.906 415.624 185.125 466.324 198.306 531H171.825L146.178 464.715L156.97 448.445Z" fill="#AADCEC" stroke="#7F00E0" strokeWidth="4"/>
          <path d="M343.03 448.445L342.128 447.085L343.279 445.929L353.519 435.636L318.781 380.508C316.209 379.75 313.674 379.263 311.172 379.041C318.094 415.624 314.875 466.324 301.694 531H328.175L353.822 464.715L343.03 448.445Z" fill="#AADCEC" stroke="#7F00E0" strokeWidth="4"/>
          <path d="M283.149 424.17L277.416 424.587L278.25 421.945C289.701 415.693 297.455 405.548 297.455 393.805V368.546C308.017 376.815 314.288 387.728 314.288 399.537C314.288 412.358 306.893 424.127 294.641 432.598L284.536 424.597L283.925 424.114L283.149 424.17ZM202.545 393.805C202.545 405.548 210.299 415.693 221.75 421.945L222.584 424.587L216.851 424.17L216.075 424.114L215.464 424.597L205.359 432.598C193.107 424.127 185.712 412.358 185.712 399.537C185.712 387.728 191.983 376.815 202.545 368.546V393.805Z" fill="#F2F2F2" stroke="#7300E0" strokeWidth="4"/>
        </g>

        {/* Animated Smile */}
        <motion.path
          d={getSmilePath()}
          stroke="#7F00E0"
          strokeWidth="2"
          strokeLinecap="round"
          fill="none"
          initial={false}
          animate={{ d: getSmilePath(), opacity: isNoseHover ? 0 : 1 }}
          transition={{ duration: 0.3, ease: 'easeInOut' }}
        />

        {/* O-shaped mouth when hovering nose */}
        <motion.ellipse
          cx="250"
          cy="298"
          rx="8"
          ry="10"
          fill="#7F00E0"
          fillOpacity="0.15"
          stroke="#7F00E0"
          strokeWidth="2"
          initial={{ scale: 0, opacity: 0 }}
          animate={{
            scale: isNoseHover ? 1 : 0,
            opacity: isNoseHover ? 1 : 0,
          }}
          transition={{ duration: 0.2, ease: 'easeOut' }}
        />

        {/* Mouth opening for expressions */}
        <mask id="path-12-inside-1_5_85" fill="white">
          <path fillRule="evenodd" clipRule="evenodd" d="M227.273 247.464C227.273 255.875 237.448 262.693 250 262.693C262.552 262.693 272.727 255.875 272.727 247.464"/>
        </mask>
        <path fillRule="evenodd" clipRule="evenodd" d="M227.273 247.464C227.273 255.875 237.448 262.693 250 262.693C262.552 262.693 272.727 255.875 272.727 247.464" fill="#AADCEC" fillOpacity="0.16"/>
        <path d="M225.273 247.464C225.273 252.542 228.344 256.898 232.816 259.894C237.301 262.899 243.382 264.693 250 264.693V260.693C244.066 260.693 238.784 259.078 235.043 256.571C231.289 254.056 229.273 250.798 229.273 247.464H225.273ZM250 264.693C256.618 264.693 262.699 262.899 267.184 259.894C271.656 256.898 274.727 252.542 274.727 247.464H270.727C270.727 250.798 268.711 254.056 264.957 256.571C261.216 259.078 255.934 260.693 250 260.693V264.693Z" fill="#7F00E0" mask="url(#path-12-inside-1_5_85)"/>

        {/* Eye lines under eyes */}
        <line id="right-eye-line" x1="295.5" y1="230.5" x2="302.5" y2="230.5" stroke="#7F00E0" strokeWidth="3" strokeLinecap="round"/>
        <line id="left-eye-line" x1="197.5" y1="230.5" x2="204.5" y2="230.5" stroke="#7F00E0" strokeWidth="3" strokeLinecap="round"/>

        {/* Interactive Left Eye - Using circles for better control */}
        <motion.g
          animate={leftEyeControls}
          style={{ transformOrigin: '200.758px 213.2px' }}
        >
          <motion.circle
            cx="200.758"
            cy="213.2"
            r="9.4"
            fill="#7F00E0"
            style={{
              x: leftEyeXSpring,
              y: leftEyeYSpring,
            }}
            animate={{
              scaleY: expression === 'wink' ? 0.1 : 1
            }}
            transition={{ duration: 0.1 }}
            filter="url(#glow)"
          />
        </motion.g>

        {/* Interactive Right Eye */}
        <motion.g
          animate={rightEyeControls}
          style={{ transformOrigin: '299.242px 213.2px' }}
        >
          <motion.circle
            cx="299.242"
            cy="213.2"
            r="9.4"
            fill="#7F00E0"
            style={{
              x: rightEyeXSpring,
              y: rightEyeYSpring,
            }}
            filter="url(#glow)"
          />
        </motion.g>

        {/* Animated Eyebrows - follow mouse with natural movement */}
        <motion.path
          id="left-eyebrow"
          d="M173.542 188.755C180.957 178.269 201.284 172.389 218.794 176.711C220.825 177.212 222.877 175.963 223.376 173.921C223.874 171.879 222.632 169.818 220.6 169.316C200.266 164.297 176.727 171.106 167.367 184.345C166.155 186.058 166.555 188.435 168.26 189.653C169.965 190.871 172.33 190.469 173.542 188.755Z"
          fill="#7F00E0"
          fillOpacity="0.6"
          style={{
            y: leftBrowYSpring,
            rotate: leftBrowRotateSpring,
            transformOrigin: '195px 180px',
          }}
        />
        <motion.path
          id="right-eyebrow"
          d="M326.458 188.755C319.044 178.269 298.717 172.389 281.207 176.711C279.175 177.212 277.124 175.963 276.625 173.921C276.126 171.879 277.369 169.818 279.4 169.316C299.735 164.297 323.273 171.106 332.634 184.345C333.845 186.058 333.446 188.435 331.74 189.653C330.035 190.871 327.67 190.469 326.458 188.755Z"
          fill="#7F00E0"
          fillOpacity="0.6"
          style={{
            y: rightBrowYSpring,
            rotate: rightBrowRotateSpring,
            transformOrigin: '305px 180px',
          }}
        />

        {/* Hair */}
        <mask id="mask2_5_85" style={{ maskType: 'alpha' }} maskUnits="userSpaceOnUse" x="0" y="0" width="500" height="533">
          <path d="M500 0H0V533H500V0Z" fill="white"/>
        </mask>
        <g mask="url(#mask2_5_85)">
          <mask id="mask3_5_85" style={{ maskType: 'alpha' }} maskUnits="userSpaceOnUse" x="136" y="186" width="230" height="229">
            <path fillRule="evenodd" clipRule="evenodd" d="M214.356 285.036C218.491 281.928 243.194 280.736 247.647 278.092C249.037 277.265 250.116 276.428 250.947 275.599C251.778 276.428 252.857 277.265 254.247 278.092C258.7 280.736 283.403 281.928 287.537 285.036C291.724 288.183 294.779 295.405 294.445 301.052C294.044 307.827 286.669 323.993 268.319 325.855C264.314 321.377 258.024 318.487 250.947 318.487C243.87 318.487 237.58 321.377 233.575 325.855C215.225 323.993 207.851 307.827 207.449 301.052C207.115 295.405 210.171 288.183 214.356 285.036ZM286.253 317.718C286.256 317.717 286.259 317.716 286.261 317.715C286.258 317.716 286.256 317.717 286.253 317.718ZM215.616 317.709C215.624 317.712 215.637 317.717 215.647 317.721C215.637 317.717 215.627 317.713 215.616 317.709ZM365.27 243.629C364.535 232.294 362.269 221.103 360.292 209.938C359.759 206.932 356.863 186.55 355.558 186.55C355.118 203.89 353.602 220.967 351.647 238.212C351.063 243.367 350.45 248.523 350.048 253.697C349.723 257.876 350.302 262.925 349.295 266.967C348.01 272.12 341.568 276.929 336.559 278.703C324.059 283.132 313.632 264.802 302.956 259.44C289.097 252.48 265.272 250.822 251.102 259.894C236.621 250.822 212.797 252.48 198.937 259.44C188.262 264.802 177.835 283.132 165.336 278.703C160.326 276.929 153.883 272.12 152.599 266.967C151.591 262.925 152.171 257.876 151.847 253.697C151.444 248.523 150.831 243.367 150.247 238.212C148.292 220.967 146.776 203.89 146.336 186.55C145.031 186.55 142.134 206.932 141.602 209.938C139.625 221.103 137.36 232.294 136.624 243.629C135.868 255.278 136.771 266.819 139.147 278.232C140.282 283.685 141.607 289.106 143.028 294.49C144.607 300.473 142.422 312.121 143.129 318.262C144.467 329.881 149.913 352.541 156.029 362.537C158.985 367.369 162.45 370.385 166.319 374.279C170.043 378.027 171.598 383.836 175.618 387.828C183.11 395.267 194.026 399.695 205.238 400.784C215.298 409.363 232.018 414.979 250.947 414.979C269.876 414.979 286.596 409.363 296.656 400.784C307.867 399.695 318.784 395.267 326.277 387.828C330.295 383.836 331.851 378.027 335.575 374.279C339.444 370.385 342.909 367.369 345.865 362.537C351.98 352.541 357.427 329.881 358.764 318.262C359.471 312.121 357.286 300.473 358.866 294.49C360.287 289.106 361.612 283.685 362.747 278.232C365.122 266.819 366.025 255.278 365.27 243.629Z" fill="white"/>
          </mask>
          <g mask="url(#mask3_5_85)">
            <motion.path
              d="M286.786 319.645C286.87 319.622 286.938 319.598 286.983 319.58C287.036 319.56 287.089 319.536 287.143 319.509L287.143 319.509L287.15 319.506L287.151 319.505L287.152 319.505C287.152 319.505 287.152 319.505 287.152 319.505L287.081 319.364C288.017 318.461 288.877 317.521 289.661 316.562C294.078 311.16 296.213 305.033 296.442 301.17C296.631 297.972 295.864 294.443 294.525 291.318C293.19 288.206 291.196 285.284 288.739 283.437L288.739 283.437C287.934 282.832 286.819 282.392 285.695 282.043C284.521 281.679 283.124 281.351 281.608 281.05C278.576 280.447 274.906 279.917 271.289 279.409C270.883 279.352 270.477 279.295 270.072 279.239C266.851 278.789 263.726 278.352 261.094 277.886C259.615 277.624 258.329 277.359 257.295 277.088C256.217 276.804 255.572 276.552 255.268 276.372C253.996 275.616 253.055 274.877 252.359 274.183L250.946 272.774L249.534 274.184C248.839 274.877 247.898 275.616 246.626 276.372C246.322 276.552 245.677 276.804 244.599 277.088C243.565 277.359 242.279 277.624 240.8 277.886C238.168 278.352 235.043 278.789 231.822 279.239C231.417 279.295 231.011 279.352 230.605 279.409C226.988 279.917 223.318 280.447 220.286 281.05C218.77 281.351 217.373 281.679 216.198 282.043C215.075 282.392 213.96 282.832 213.155 283.437L213.154 283.437C210.698 285.284 208.704 288.206 207.37 291.318C206.03 294.443 205.263 297.972 205.453 301.17C205.682 305.033 207.816 311.16 212.233 316.562C213.039 317.548 213.924 318.513 214.891 319.439L214.846 319.555C214.87 319.565 214.89 319.572 214.9 319.576L214.906 319.578L214.907 319.579L214.914 319.581L214.918 319.583L214.926 319.586L214.94 319.592L214.942 319.592L214.942 319.592C214.945 319.593 214.947 319.594 214.95 319.595L214.976 319.52M286.786 319.645C286.773 319.649 286.76 319.652 286.746 319.655M286.786 319.645C286.773 319.649 286.76 319.652 286.746 319.655M286.786 319.645C282.412 323.755 276.405 327.045 268.521 327.845L267.507 327.948L266.828 327.189C263.225 323.159 257.489 320.487 250.947 320.487C244.405 320.487 238.669 323.159 235.066 327.189L234.387 327.948L233.373 327.845C225.409 327.037 219.361 323.688 214.976 319.52M286.746 319.655L286.357 317.925L286.271 317.753L286.268 317.747L286.653 319.676C286.686 319.67 286.717 319.663 286.746 319.655ZM214.976 319.52L215.082 319.222L214.971 319.515C214.973 319.517 214.975 319.519 214.976 319.52ZM351.647 238.212L353.634 238.437C355.032 226.113 356.207 213.856 356.927 201.517C357.146 202.86 357.351 204.154 357.535 205.326C357.634 205.958 357.728 206.557 357.814 207.111C358.044 208.578 358.222 209.722 358.322 210.286C358.322 210.287 358.322 210.287 358.322 210.287L351.647 238.212ZM351.647 238.212L353.634 238.437C353.567 239.03 353.5 239.622 353.432 240.213C352.912 244.781 352.395 249.31 352.042 253.852C351.93 255.286 351.931 256.798 351.933 258.424C351.933 259.065 351.934 259.724 351.927 260.402C351.905 262.71 351.8 265.185 351.236 267.451L351.236 267.452C350.451 270.598 348.174 273.422 345.63 275.617C343.056 277.837 339.979 279.614 337.227 280.589C329.821 283.212 323.267 278.953 317.775 274.264C316.087 272.823 314.363 271.216 312.693 269.658C311.639 268.675 310.605 267.711 309.616 266.822C306.96 264.436 304.474 262.44 302.059 261.227C295.443 257.904 286.327 255.801 277.114 255.655C267.887 255.508 258.821 257.327 252.18 261.579L251.113 262.262L250.04 261.589C243.235 257.326 234.082 255.508 224.818 255.655C215.566 255.801 206.451 257.905 199.835 261.227C197.42 262.44 194.934 264.436 192.278 266.822C191.289 267.711 190.256 268.675 189.201 269.658C187.531 271.215 185.807 272.823 184.119 274.264C178.627 278.953 172.073 283.212 164.668 280.589C161.916 279.614 158.838 277.837 156.264 275.617C153.72 273.422 151.443 270.598 150.659 267.451C150.094 265.185 149.989 262.711 149.967 260.402C149.96 259.723 149.961 259.063 149.961 258.42C149.963 256.796 149.964 255.285 149.853 253.852L351.647 238.212ZM148.259 238.437L148.259 238.437C146.863 226.112 145.687 213.855 144.967 201.515C144.748 202.859 144.543 204.154 144.358 205.326C144.258 205.965 144.163 206.57 144.076 207.129C143.848 208.588 143.671 209.725 143.571 210.286L143.571 210.286C143.263 212.027 142.949 213.762 142.636 215.495C140.926 224.947 139.234 234.298 138.62 243.759L138.62 243.759C137.877 255.217 138.763 266.577 141.105 277.825L141.105 277.825C142.23 283.233 143.547 288.618 144.962 293.98C145.849 297.339 145.658 302.088 145.402 306.434C145.363 307.096 145.323 307.749 145.283 308.392C145.048 312.183 144.836 315.6 145.116 318.033C145.771 323.719 147.443 332.186 149.716 340.479C152.001 348.816 154.833 356.749 157.735 361.493C160.047 365.272 162.65 367.838 165.726 370.872C166.375 371.511 167.045 372.172 167.738 372.869L167.738 372.869C169.753 374.897 171.172 377.432 172.457 379.725C172.505 379.811 172.554 379.898 172.602 379.984C173.976 382.434 175.245 384.639 177.027 386.409C184.126 393.458 194.577 397.74 205.431 398.793L206.057 398.854L206.536 399.262C216.141 407.454 232.356 412.979 250.947 412.979C269.539 412.979 285.753 407.454 295.359 399.262L295.837 398.854L296.463 398.793C307.316 397.74 317.767 393.458 324.868 386.408C326.649 384.639 327.918 382.434 329.292 379.984C329.34 379.898 329.388 379.812 329.436 379.726C330.721 377.432 332.141 374.897 334.157 372.869C334.85 372.171 335.521 371.51 336.17 370.869C339.245 367.837 341.848 365.271 344.159 361.493C347.061 356.749 349.893 348.816 352.178 340.479C354.451 332.186 356.123 323.719 356.777 318.033C357.058 315.6 356.846 312.184 356.611 308.394C356.571 307.75 356.53 307.096 356.491 306.434C356.236 302.088 356.045 297.339 356.932 293.98C358.347 288.618 359.663 283.233 360.789 277.825L148.259 238.437ZM148.259 238.437C148.328 239.04 148.396 239.642 148.465 240.243M148.259 238.437L148.465 240.243M148.465 240.243C148.985 244.801 149.5 249.32 149.853 253.852L148.465 240.243Z"
              fill="#7F00E0"
              stroke="#7F00E0"
              strokeWidth="4"
            />
          </g>

          {/* Hair top part */}
          <path fillRule="evenodd" clipRule="evenodd" d="M141.156 185.598C139.26 181.012 138.258 176.232 138.258 171.321C138.258 136.628 188.286 108.504 250 108.504C311.714 108.504 361.742 136.628 361.742 171.321C361.742 176.232 360.74 181.012 358.844 185.598C347.345 157.783 302.978 137.057 250 137.057C197.022 137.057 152.655 157.783 141.156 185.598Z" fill="#AADCEC"/>

          <mask id="mask4_5_85" style={{ maskType: 'alpha' }} maskUnits="userSpaceOnUse" x="90" y="5" width="320" height="264">
            <path d="M176.509 159.645C154.57 182.234 139.645 214.831 145.259 267.735C127.372 262.939 113.966 253.288 105.003 238.788C95.9143 224.086 91.3675 204.355 91.4095 179.552C91.4852 134.828 116.052 91.4868 147.72 59.3063C163.549 43.221 181.137 29.9411 198.294 20.6851C215.457 11.4253 232.156 6.21072 246.212 6.21072C247.463 6.21072 248.707 6.26646 249.94 6.37638L249.984 6.38032L250.028 6.37642C251.272 6.26648 252.526 6.21072 253.788 6.21072C267.809 6.21072 284.489 11.4252 301.645 20.685C318.795 29.9411 336.388 43.2211 352.226 59.3064C383.912 91.487 408.514 134.829 408.591 179.552C408.633 203.744 404.087 223.172 394.997 237.876C386.034 252.375 372.628 262.322 354.744 267.711C360.329 214.821 345.364 182.23 323.4 159.645C306.389 142.153 285.173 130.671 266.203 120.404C260.71 117.431 255.406 114.56 250.446 111.675V111.093L249.694 111.53C244.682 114.45 239.317 117.353 233.76 120.359C214.761 130.637 193.523 142.127 176.509 159.645Z" fill="white" stroke="#7F00E0"/>
          </mask>
          <g mask="url(#mask4_5_85)" id="pagg">
            <motion.path
              d="M175.433 158.6C153.467 181.216 138.527 213.67 143.544 265.693C127.046 260.811 114.67 251.574 106.279 237.999C97.3872 223.616 92.8677 204.191 92.9094 179.555C92.9843 135.361 117.282 92.3752 148.789 60.3584C164.523 44.3699 181.992 31.1839 199.006 22.0052C216.047 12.8115 232.495 7.71072 246.212 7.71072C247.419 7.71072 248.618 7.76448 249.807 7.87046L249.984 7.88622L250.16 7.87059C251.36 7.76452 252.57 7.71072 253.788 7.71072C267.469 7.71072 283.898 12.8111 300.933 22.005C317.94 31.1839 335.414 44.3701 351.157 60.3588C382.682 92.3762 407.015 135.362 407.091 179.555C407.132 203.572 402.617 222.697 393.721 237.087C385.331 250.66 372.955 260.169 356.464 265.596C361.431 213.628 346.455 181.201 324.476 158.599C307.288 140.925 285.79 129.293 266.792 119.013C261.611 116.21 256.617 113.508 251.946 110.811V108.483L248.939 110.234C244.004 113.109 238.692 115.982 233.17 118.969C214.144 129.26 192.624 140.9 175.433 158.6Z"
              fill="white"
              stroke="#7F00E0"
              strokeWidth="4"
              animate={{ scale: isHovering ? 1.01 : 1 }}
              transition={{ duration: 0.3 }}
            />
          </g>

          <path fillRule="evenodd" clipRule="evenodd" d="M90.9301 182.766C91.6303 230.546 109.932 259.091 145.834 268.404C109.133 259.436 90.8253 231.536 90.9095 184.702C90.9107 184.057 90.9176 183.411 90.9301 182.766ZM289.102 57.9982C290.512 68.9004 288.118 81.6427 280.303 95.437C259.181 136.232 145.298 128.157 144.867 237.946C144.434 120.08 259.396 119.354 280.599 75.8848C285.655 66.4101 288.146 66.3112 289.102 57.9982Z" fill="#7F00E0"/>

          {/* Glasses */}
          <g filter="url(#shadow)">
            <path fillRule="evenodd" clipRule="evenodd" d="M267.925 193.011C275.341 177.905 290.819 167.514 308.712 167.514C325.605 167.514 340.346 176.777 348.182 190.525C348.58 190.416 348.999 190.357 349.432 190.357H364.583C367.198 190.357 369.318 192.488 369.318 195.116C369.318 197.744 367.198 199.875 364.583 199.875H352.203C353.48 204.091 354.167 208.565 354.167 213.2C354.167 238.432 333.816 258.886 308.712 258.886C283.608 258.886 263.258 238.432 263.258 213.2C263.258 210.493 263.492 207.842 263.941 205.264C263.781 196.935 257.412 190.357 249.739 190.357C242.662 190.357 236.695 195.953 235.685 203.359C236.378 206.528 236.742 209.821 236.742 213.2C236.742 238.432 216.392 258.886 191.288 258.886C166.184 258.886 145.833 238.432 145.833 213.2C145.833 208.565 146.52 204.091 147.797 199.875H135.417C132.802 199.875 130.682 197.744 130.682 195.116C130.682 192.488 132.802 190.357 135.417 190.357H150.568C151.001 190.357 151.42 190.416 151.818 190.525C159.654 176.777 174.395 167.514 191.288 167.514C209 167.514 224.346 177.697 231.848 192.556C235.782 186.625 242.328 182.743 249.739 182.743C257.338 182.743 264.028 186.824 267.925 193.011ZM191.288 251.271C212.208 251.271 229.167 234.226 229.167 213.2C229.167 192.174 212.208 175.129 191.288 175.129C170.368 175.129 153.409 192.174 153.409 213.2C153.409 234.226 170.368 251.271 191.288 251.271ZM308.712 251.271C329.632 251.271 346.591 234.226 346.591 213.2C346.591 192.174 329.632 175.129 308.712 175.129C287.792 175.129 270.833 192.174 270.833 213.2C270.833 234.226 287.792 251.271 308.712 251.271Z" fill="#AADCEC"/>
            <path d="M267.079 193.544L268.034 195.059L268.823 193.452C276.078 178.673 291.217 168.514 308.712 168.514C325.23 168.514 339.647 177.57 347.313 191.02L347.697 191.695L348.446 191.489C348.759 191.403 349.089 191.357 349.432 191.357H364.583C366.641 191.357 368.318 193.035 368.318 195.116C368.318 197.197 366.641 198.875 364.583 198.875H352.203H350.855L351.246 200.165C352.495 204.288 353.167 208.664 353.167 213.2C353.167 237.884 333.259 257.886 308.712 257.886C284.165 257.886 264.258 237.884 264.258 213.2C264.258 210.551 264.487 207.957 264.926 205.436L264.943 205.341L264.941 205.245C264.771 196.43 258.015 189.357 249.739 189.357C242.108 189.357 235.764 195.378 234.694 203.224L234.67 203.399L234.708 203.572C235.385 206.672 235.742 209.894 235.742 213.2C235.742 237.884 215.835 257.886 191.288 257.886C166.741 257.886 146.833 237.884 146.833 213.2C146.833 208.664 147.505 204.288 148.754 200.165L149.145 198.875H147.797H135.417C133.359 198.875 131.682 197.197 131.682 195.116C131.682 193.035 133.359 191.357 135.417 191.357H150.568C150.911 191.357 151.241 191.403 151.554 191.489L152.303 191.695L152.687 191.02C160.353 177.57 174.77 168.514 191.288 168.514C208.606 168.514 223.616 178.47 230.955 193.006L231.73 194.542L232.681 193.108C236.446 187.433 242.691 183.743 249.739 183.743C256.967 183.743 263.35 187.623 267.079 193.544ZM191.288 252.271C212.765 252.271 230.167 234.774 230.167 213.2C230.167 191.626 212.765 174.129 191.288 174.129C169.811 174.129 152.409 191.626 152.409 213.2C152.409 234.774 169.811 252.271 191.288 252.271ZM308.712 252.271C330.189 252.271 347.591 234.774 347.591 213.2C347.591 191.626 330.189 174.129 308.712 174.129C287.235 174.129 269.833 191.626 269.833 213.2C269.833 234.774 287.235 252.271 308.712 252.271Z" stroke="#7F00E0" strokeWidth="2"/>
          </g>
          <path d="M267.079 193.544L268.034 195.059L268.823 193.452C276.078 178.673 291.217 168.514 308.712 168.514C325.23 168.514 339.647 177.57 347.313 191.02L347.697 191.695L348.446 191.489C348.759 191.403 349.089 191.357 349.432 191.357H364.583C366.641 191.357 368.318 193.035 368.318 195.116C368.318 197.197 366.641 198.875 364.583 198.875H352.203H350.855L351.246 200.165C352.495 204.288 353.167 208.664 353.167 213.2C353.167 237.884 333.259 257.886 308.712 257.886C284.165 257.886 264.258 237.884 264.258 213.2C264.258 210.551 264.487 207.957 264.926 205.436L264.943 205.341L264.941 205.245C264.771 196.43 258.015 189.357 249.739 189.357C242.108 189.357 235.764 195.378 234.694 203.224L234.67 203.399L234.708 203.572C235.385 206.672 235.742 209.894 235.742 213.2C235.742 237.884 215.835 257.886 191.288 257.886C166.741 257.886 146.833 237.884 146.833 213.2C146.833 208.664 147.505 204.288 148.754 200.165L149.145 198.875H147.797H135.417C133.359 198.875 131.682 197.197 131.682 195.116C131.682 193.035 133.359 191.357 135.417 191.357H150.568C150.911 191.357 151.241 191.403 151.554 191.489L152.303 191.695L152.687 191.02C160.353 177.57 174.77 168.514 191.288 168.514C208.606 168.514 223.616 178.47 230.955 193.006L231.73 194.542L232.681 193.108C236.446 187.433 242.691 183.743 249.739 183.743C256.967 183.743 263.35 187.623 267.079 193.544ZM191.288 252.271C212.765 252.271 230.167 234.774 230.167 213.2C230.167 191.626 212.765 174.129 191.288 174.129C169.811 174.129 152.409 191.626 152.409 213.2C152.409 234.774 169.811 252.271 191.288 252.271ZM308.712 252.271C330.189 252.271 347.591 234.774 347.591 213.2C347.591 191.626 330.189 174.129 308.712 174.129C287.235 174.129 269.833 191.626 269.833 213.2C269.833 234.774 287.235 252.271 308.712 252.271Z" fill="#AADCEC" stroke="#7F00E0" strokeWidth="2"/>
        </g>
      </svg>

      {/* Floating particles around avatar */}
      <motion.div
        className="absolute -top-4 -right-4 w-3 h-3 rounded-full bg-purple/30"
        animate={{
          y: [0, -10, 0],
          opacity: [0.3, 0.6, 0.3]
        }}
        transition={{ duration: 3, repeat: Infinity, ease: 'easeInOut' }}
      />
      <motion.div
        className="absolute top-1/4 -left-6 w-2 h-2 rounded-full bg-teal/50"
        animate={{
          y: [0, 15, 0],
          x: [0, 5, 0],
          opacity: [0.5, 0.8, 0.5]
        }}
        transition={{ duration: 4, repeat: Infinity, ease: 'easeInOut', delay: 0.5 }}
      />
      <motion.div
        className="absolute bottom-1/4 -right-8 w-4 h-4 rounded-full bg-purple/20"
        animate={{
          y: [0, -20, 0],
          opacity: [0.2, 0.5, 0.2]
        }}
        transition={{ duration: 5, repeat: Infinity, ease: 'easeInOut', delay: 1 }}
      />
    </motion.div>
  )
}
